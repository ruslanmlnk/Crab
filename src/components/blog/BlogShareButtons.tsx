'use client'

import React from 'react'

type BlogShareButtonsProps = {
  title: string
}

export const BlogShareButtons: React.FC<BlogShareButtonsProps> = ({ title }) => {
  const iconButtonClass =
    'flex h-10 w-10 items-center justify-center rounded-full border border-[#0C2B3A] text-[#071A26] transition-all duration-200 ease-out hover:-translate-y-0.5 hover:border-[#071A26] hover:bg-[#071A26] hover:text-white'

  const getPageUrl = (): string => {
    if (typeof window === 'undefined') {
      return ''
    }

    return window.location.href
  }

  const shareNativelyOrCopy = async (): Promise<void> => {
    const url = getPageUrl()

    if (!url) {
      return
    }

    if (typeof navigator !== 'undefined' && typeof navigator.share === 'function') {
      try {
        await navigator.share({
          title,
          url,
        })
        return
      } catch {
        // User canceled or share failed - fall back to clipboard.
      }
    }

    if (typeof navigator !== 'undefined' && navigator.clipboard?.writeText) {
      try {
        await navigator.clipboard.writeText(url)
      } catch {
        // No-op fallback.
      }
    }
  }

  const shareTelegram = (): void => {
    const url = getPageUrl()

    if (!url || typeof window === 'undefined') {
      return
    }

    const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`
    window.open(telegramUrl, '_blank', 'noopener,noreferrer')
  }

  return (
    <div className="flex items-center gap-3">
      <button
        aria-label="Share article"
        className={iconButtonClass}
        onClick={shareNativelyOrCopy}
        type="button"
      >
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.62 2.36389H3.37917C1.69677 2.36389 0.328125 3.73692 0.328125 5.42433V10.5755C0.328125 12.2632 1.69677 13.6359 3.37917 13.6359H12.62C14.3024 13.6359 15.671 12.2629 15.671 10.5755V5.42433C15.671 3.73692 14.3024 2.36389 12.62 2.36389ZM15.0448 10.5758C15.0448 11.9181 13.957 13.01 12.62 13.01H3.37917C2.04214 13.01 0.954365 11.9178 0.954365 10.5758V5.42433C0.954365 4.08229 2.04214 2.99013 3.37917 2.99013H12.62C13.957 2.99013 15.0448 4.08229 15.0448 5.42433V10.5758Z" fill="currentColor" />
          <path d="M10.7734 7.88659L6.43511 5.34562C6.38751 5.31799 6.33348 5.30337 6.27844 5.30322C6.2234 5.30308 6.16929 5.31742 6.12154 5.34479C6.07379 5.37217 6.03409 5.41163 6.00641 5.45921C5.97874 5.50678 5.96406 5.5608 5.96387 5.61584V10.6975C5.96403 10.7805 5.99707 10.86 6.05576 10.9187C6.11445 10.9774 6.19399 11.0104 6.27699 11.0106C6.33257 11.0106 6.38715 10.9958 6.43511 10.9677L10.7734 8.42735C10.8206 8.39976 10.8598 8.36028 10.887 8.31285C10.9143 8.26541 10.9286 8.21166 10.9286 8.15697C10.9286 8.10227 10.9143 8.04853 10.887 8.00109C10.8598 7.95365 10.8206 7.91418 10.7734 7.88659ZM6.59011 10.1511V6.16192L9.9956 8.15681L6.59011 10.1511Z" fill="currentColor" />
        </svg>
      </button>

      <button
        aria-label="Share article"
        className={iconButtonClass}
        onClick={shareNativelyOrCopy}
        type="button"
      >
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.01883 3.875C10.2688 3.875 12.126 5.73214 12.126 7.98214C12.126 10.2679 10.2688 12.0893 8.01883 12.0893C5.73312 12.0893 3.91169 10.2679 3.91169 7.98214C3.91169 5.73214 5.73312 3.875 8.01883 3.875ZM8.01883 10.6607C9.48312 10.6607 10.6617 9.48214 10.6617 7.98214C10.6617 6.51786 9.48312 5.33929 8.01883 5.33929C6.51883 5.33929 5.34026 6.51786 5.34026 7.98214C5.34026 9.48214 6.55455 10.6607 8.01883 10.6607ZM13.2331 3.73214C13.2331 4.26786 12.8045 4.69643 12.2688 4.69643C11.7331 4.69643 11.3045 4.26786 11.3045 3.73214C11.3045 3.19643 11.7331 2.76786 12.2688 2.76786C12.8045 2.76786 13.2331 3.19643 13.2331 3.73214ZM15.9474 4.69643C16.0188 6.01786 16.0188 9.98214 15.9474 11.3036C15.876 12.5893 15.5903 13.6964 14.6617 14.6607C13.7331 15.5893 12.5903 15.875 11.3045 15.9464C9.98312 16.0179 6.01883 16.0179 4.69741 15.9464C3.41169 15.875 2.30455 15.5893 1.34026 14.6607C0.411691 13.6964 0.125977 12.5893 0.054548 11.3036C-0.0168806 9.98214 -0.0168806 6.01786 0.054548 4.69643C0.125977 3.41071 0.411691 2.26786 1.34026 1.33929C2.30455 0.410714 3.41169 0.125 4.69741 0.0535714C6.01883 -0.0178571 9.98312 -0.0178571 11.3045 0.0535714C12.5903 0.125 13.7331 0.410714 14.6617 1.33929C15.5903 2.26786 15.876 3.41071 15.9474 4.69643ZM14.2331 12.6964C14.6617 11.6607 14.5545 9.16071 14.5545 7.98214C14.5545 6.83929 14.6617 4.33929 14.2331 3.26786C13.9474 2.58929 13.4117 2.01786 12.7331 1.76786C11.6617 1.33929 9.16169 1.44643 8.01883 1.44643C6.84026 1.44643 4.34026 1.33929 3.30455 1.76786C2.59026 2.05357 2.05455 2.58929 1.76883 3.26786C1.34026 4.33929 1.44741 6.83929 1.44741 7.98214C1.44741 9.16071 1.34026 11.6607 1.76883 12.6964C2.05455 13.4107 2.59026 13.9464 3.30455 14.2321C4.34026 14.6607 6.84026 14.5536 8.01883 14.5536C9.16169 14.5536 11.6617 14.6607 12.7331 14.2321C13.4117 13.9464 13.9831 13.4107 14.2331 12.6964Z" fill="currentColor" />
        </svg>
      </button>

      <button
        aria-label="Share in Telegram"
        className={iconButtonClass}
        onClick={shareTelegram}
        type="button"
      >
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.755 1.71985C15.5598 1.48009 15.2667 1.34802 14.9296 1.34802C14.7478 1.34802 14.5552 1.38609 14.3571 1.46112L0.81115 6.5935C0.0909044 6.86645 -0.00603664 7.2773 0.000276097 7.49791C0.00655758 7.71741 0.125656 8.11912 0.85062 8.351L3.72338 9.40376L5.23741 12.8694C5.3896 13.3487 5.70761 13.685 6.1135 13.7941C6.20655 13.8191 6.30248 13.8317 6.39883 13.8316C6.72846 13.8316 7.06598 13.6864 7.35745 13.4127L8.61181 12.2342L11.6724 14.3408C11.948 14.5445 12.2479 14.652 12.5404 14.652C13.134 14.652 13.6074 14.2175 13.7465 13.545L15.9619 2.83014C16.053 2.38978 15.9795 1.99548 15.755 1.71985ZM4.67545 9.2411L8.58469 7.14474L5.86021 9.64386C5.8125 9.68776 5.77443 9.74109 5.74841 9.80046C5.72238 9.85984 5.70897 9.92398 5.70902 9.98881C5.70883 9.99362 5.70824 9.99831 5.70821 10.0031L5.6988 11.5836L4.67545 9.2411ZM6.71556 12.7293C6.68826 12.7551 6.65937 12.7791 6.62905 12.8012L6.64052 10.8773L7.82153 11.6902L6.71556 12.7293ZM15.0438 2.64029L12.8284 13.3551C12.8061 13.4632 12.7332 13.7145 12.5403 13.7145C12.4502 13.7145 12.3385 13.6681 12.2257 13.5838C12.2208 13.5802 12.2159 13.5767 12.2109 13.5733L8.83679 11.2509L8.83542 11.25L6.92772 9.93687L11.9671 5.31433C12.0513 5.23713 12.1044 5.13186 12.1164 5.0183C12.1284 4.90473 12.0986 4.79068 12.0325 4.69755C11.9664 4.60443 11.8686 4.53863 11.7574 4.51253C11.6462 4.48642 11.5293 4.50179 11.4287 4.55577L4.03643 8.51998L1.1636 7.46722C1.1615 7.46644 1.1594 7.46568 1.15729 7.46494L14.6893 2.33784C14.8034 2.29462 14.883 2.28556 14.9296 2.28556C14.9528 2.28556 15.0087 2.28812 15.0281 2.31187C15.0528 2.34228 15.084 2.44569 15.0438 2.64029Z" fill="currentColor" />
        </svg>
      </button>
    </div>
  )
}
